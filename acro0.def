\ProvidesFile{acro0.def}

% --------------------------------------------------------------------------
% adding an acronym, internal command:
% #1: use/replace plural (boolean)
% #2: id
% #3: short
% #4: short plural
% #5: alt
% #6: long
% #7: long plural
% #8: class
% #9: extra
\cs_new:Npn \acro_new:nnnnnnnnn #1#2#3#4#5#6#7#8#9
  {
    \IfBooleanTF { #1 }
      { \prop_put:Nnn \l__acro_replace_plural_prop { #2 } { \c_true_bool } }
      { \prop_put:Nnn \l__acro_replace_plural_prop { #2 } { \c_false_bool } }
    \prop_put:Nnn \l__acro_short_prop { #2 } { #3 }
    \prop_put:Nnn \l__acro_pdfstring_prop { #2 } { #3 }
    \IfNoValueTF { #4 }
      {
        \prop_put:Nnn \l__acro_short_plural_prop
          { #2 } { \l__acro_default_plural_tl }
        \prop_put:Nnx \l__acro_pdfstring_plural_prop
          { #2 } { \exp_not:n { #3 } \exp_not:V \l__acro_default_plural_tl }
      }
      {
        \prop_put:Nnn \l__acro_short_plural_prop { #2 } { #4 }
        \prop_put:Nnx \l__acro_pdfstring_plural_prop { #2 } { \exp_not:n { #3 #4 } }
      }
    \IfNoValueTF { #5 }
      { \prop_put:Nnn \l__acro_alt_prop { #2 } { #2 } }
      { \prop_put:Nnn \l__acro_alt_prop { #2 } { #5 } }
    \prop_put:Nnn \l__acro_long_prop { #2 } { #6 }
    \IfNoValueTF { #7 }
      { \prop_put:Nnn \l__acro_long_plural_prop { #2 } { \l__acro_default_plural_tl } }
      { \prop_put:Nnn \l__acro_long_plural_prop { #2 } { #7 } }
    \IfNoValueF { #8 }
      { \prop_put:Nnn \l__acro_class_prop { #2 } { #8 } }
    \IfNoValueF { #9 }
      { \prop_put:Nnn \l__acro_extra_prop { #2 } { #9 } }
    \bool_new:c { g__acro_#2_used_bool }
    \bool_new:c { g__acro_#2_label_bool }
    \bool_if:NT \l__acro_create_macros_bool
      {
        \cs_if_exist:cTF { #2 }
          {
            \bool_if:NT \l__acro_strict_bool
              { \cs_set:cpn { #2 } { \ac { #2 } \acro_xspace: } }
          }
          { \cs_new:cpn { #2 } { \ac { #2 } \acro_xspace: } }
      }
  }

% set custom format:
\cs_new:Npn \acro_format:nn #1#2
  { \prop_put:Nnn \l__acro_format_prop { #1 } { #2 } }

% add citation:
\cs_new:Npn \acro_citation:nnnn #1#2#3#4
  {
    \prop_put:Nnn \l__acro_citation_prop { #1 } { #4 }
    \IfNoValueF { #2 }
      { \prop_put:Nnn \l__acro_citation_pre_prop { #1 } { #2 } }
    \IfNoValueF { #3 }
      { \prop_put:Nnn \l__acro_citation_post_prop { #1 } { #3 } }
  }

% add pdfstring:
\cs_new:Npn \acro_pdfstring:nnn #1#2#3
  {
    \prop_put:Nnx \l__acro_pdfstring_prop { #1 } { #2 }
    \IfNoValueTF { #3 }
      {
        \prop_put:Nnx \l__acro_pdfstring_plural_prop
          { #1 } { #2 \l__acro_default_plural_tl }
      }
      {
        \prop_put:Nnx \l__acro_pdfstring_plural_prop
          { #1 } { #2 #3 }
      }
  }

% --------------------------------------------------------------------------
% USER COMMANDS
% adding an acronym, user command:
% #1: use/replace plural (boolean)
% #2: id
% #3: short
% #4: short plural
% #5: alt
% #6: long
% #7: long plural
% #8: class
% #9: extra
\NewDocumentCommand \DeclareAcronym
  { sm>{\SplitArgument{1}{,}}mo>{\SplitArgument{1}{,}}+mgo }
  { \acro_new:nnnnnnnnn { #1 } { #2 } #3 { #4 } #5 { #7 } { #6 } }
\@onlypreamble \DeclareAcronym

\NewDocumentCommand \DeclareAcronymFormat { mm }
  { \acro_format:nn { #1 } { #2 } }
\@onlypreamble \DeclareAcronymFormat

\NewDocumentCommand \DeclareAcronymCitation { moom }
  { \acro_citation:nnnn { #1 } { #2 } { #3 } { #4 } }
\@onlypreamble \DeclareAcronymCitation

\NewDocumentCommand \DeclareAcronymPDFString
  { m >{ \SplitArgument { 1 } { , } } m }
  { \acro_pdfstring:nnn { #1 } #2 }
\@onlypreamble \DeclareAcronymPDFstring

\tex_endinput:D